I"<p><img src="/assets/img/posts/kgl_tabular_1/kgl_tabular1_eda3.png" alt="eda3" />
이는 첫번째 방법, 모든 값들에 대해 일괄적으로 linear regression을 적용한 것이다. 
위는 해당 regression의 train set 위에서의 그래프, 아래는 test set 위에서의 그래프이다.
제일 아래의 값 19560은 test set에서 측정한 MSE(mean square error)이다.</p>

<p><img src="/assets/img/posts/kgl_tabular_1/kgl_tabular1_eda4.png" alt="eda4" />
이는 두번째 방법, 3년을 1년단위로 나눠 3일씩 뽑은뒤 각각 regression을 적용해 준 것이다. 
test set에 해당 regression을 이용하여 예측한 결과 비슷한 모양을 띄고 있었으나 한눈에 보기에 편차가 매우 큼을 알 수 있다. 
그러나 일단 그래프의 개형을 따라간다는 점 덕분인지 MSE가 30%이상 감소하였다.
또한 그래프의 x축 오프셋이 조금 틀어져 있는 점을 알 수 있는데, 이 이유는 마지막에 후술하겠다.</p>

<p><img src="/assets/img/posts/kgl_tabular_1/kgl_tabular1_eda5.png" alt="eda5" />
마지막으로 그래프 전체에 대해 비례상수 $\alpha$를 찾아서 예측한 것이다. 
$\alpha$ 값은 데이터에 log를 씌운 뒤 다시 linear regression을 통해 구하였다. 자세한 코드는 다음과 같다. 
<img src="/assets/img/posts/kgl_tabular_1/percentage_regression_code.png" alt="percentage_regression" />
여기서 1/6, 1/3, 1/2는 기하평균을 낼 때 가중치로 사용한 파라미터인데, 이는 몇 번의 실험으로 얻어냈으며 왜 이게 좋은 결과가 
나오는지는 파악하지 못하였다.<br />
이 방법으로 나타낸 예측 그래프는 테스트 그래프를 상당히 잘 따라가는 모습을 볼 수 있으며 MSE또한 처음의 방법에 비해 70%가까이 감소하였다. 
따라서 이 방법을 선택하여 캐글에 결과물을 제출하였고 그 결과로 16.45점으로 939등에 랭크되었다. 
<img src="/assets/img/posts/kgl_tabular_1/result.png" alt="result" />
여기서 16점은 내가 제출한 예측 데이터가 실제 데이터와 평균 16% 차이가 났음을 의미한다. 
16%면 상당히 괜찮지않은가? 싶지만 이 competition의 참가자수는 이 시점에 1050명 가량이였다. 즉, 939등은 하위 10%의 저조한 성적에 해당한다.. 
상위 50등안에 드는 사람들은 거의 4점, 즉 평균 4% 가량의 아주 작은 오차만 나고있었다.</p>

<p>왜 이렇게 저조한 결과가 나온 것일까? 나는 이걸 캐글에 제출하러 갈 때야 알 수 있었다. 첫 눈에 그래프만 보고 아주 큰 값이나 뚜렷하게 나타나는 
개형만 파악하면 충분할 것이라고 생각하였다. 하지만 실제 물건의 판매량은 주말과 주중에 다르고, 계절에 따라 다르고, 연휴만이 아닌 블랙프라이등의 
1년마다는 돌지 않는 행사등에 의해서도 달라질 수 있다. 이런 점들을 간과하고 오로지 1년단위로 경향만 파악하여 regression을 하였으니 
세가지 방법으로도 16%의 오차가 날 수 밖에 없었던 것이다.<br />
그렇다면 이런 점까지 고려해서 어떻게 개선할 수 있을까? 가장 쉽고 확실한 방법으로 도메인 지식을 활용하는 것이다. 
이미 년도가 test set에서 주어져있기 때문에 주말이 언제인지, 큰 행사는 언제인지등을 미리 파악하고 이를 결과에 반영하면 된다. 
하지만 어려운 점은 ‘그런 알고리즘을 어떻게 설계할 것인가’이다. 이는 지금 배우고있는 베이시안 통계를 이용할 수 있어 보인다. 
요점은 p(판매량|주말,여름,물건,국가,상점)을 구하는 것이기 때문이다.<br />
이 부분에 대해 시도해 볼 수 있으면 좋겠으나 당장 주어진 다른 캐글 과제도 있고, 데이터 분석 과제도 있기 때문에 
개인적으로 시작했던 이번 캐글 대회는 여기서 잠시 맺어두고 기회가 있으면 추후에 다시 해보는 걸로 마무리한다.</p>

:ET